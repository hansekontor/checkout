{"ast":null,"code":"/*!\n * md5sha1.js - MD5-SHA1 implementation for bcrypto\n * Copyright (c) 2018-2019, Christopher Jeffrey (MIT License).\n * https://github.com/bcoin-org/bcrypto\n */\n'use strict';\n\nconst assert = require('../internal/assert');\n\nconst MD5 = require('./md5');\n\nconst SHA1 = require('./sha1');\n\nconst HMAC = require('../internal/hmac');\n/**\n * MD5SHA1\n */\n\n\nclass MD5SHA1 {\n  constructor() {\n    this.md5 = new MD5();\n    this.sha1 = new SHA1();\n  }\n\n  init() {\n    this.md5.init();\n    this.sha1.init();\n    return this;\n  }\n\n  update(data) {\n    this.md5.update(data);\n    this.sha1.update(data);\n    return this;\n  }\n\n  final() {\n    const md = Buffer.allocUnsafe(36);\n    this.md5.final().copy(md, 0);\n    this.sha1.final().copy(md, 16);\n    return md;\n  }\n\n  static hash() {\n    return new MD5SHA1();\n  }\n\n  static hmac() {\n    return new HMAC(MD5SHA1, 64);\n  }\n\n  static digest(data) {\n    return MD5SHA1.ctx.init().update(data).final();\n  }\n\n  static root(left, right) {\n    assert(Buffer.isBuffer(left) && left.length === 36);\n    assert(Buffer.isBuffer(right) && right.length === 36);\n    return MD5SHA1.ctx.init().update(left).update(right).final();\n  }\n\n  static multi(x, y, z) {\n    const {\n      ctx\n    } = MD5SHA1;\n    ctx.init();\n    ctx.update(x);\n    ctx.update(y);\n    if (z) ctx.update(z);\n    return ctx.final();\n  }\n\n  static mac(data, key) {\n    return MD5SHA1.hmac().init(key).update(data).final();\n  }\n\n}\n/*\n * Static\n */\n\n\nMD5SHA1.native = 0;\nMD5SHA1.id = 'MD5SHA1';\nMD5SHA1.size = 36;\nMD5SHA1.bits = 288;\nMD5SHA1.blockSize = 64;\nMD5SHA1.zero = Buffer.alloc(36, 0x00);\nMD5SHA1.ctx = new MD5SHA1();\n/*\n * Expose\n */\n\nmodule.exports = MD5SHA1;","map":null,"metadata":{},"sourceType":"script"}