{"ast":null,"code":"/*!\n * hash160.js - Hash160 implementation for bcrypto\n * Copyright (c) 2017-2019, Christopher Jeffrey (MIT License).\n * https://github.com/bcoin-org/bcrypto\n *\n * Resources:\n *   https://github.com/bitcoin/bitcoin/blob/master/src/hash.h\n */\n'use strict';\n\nconst assert = require('../internal/assert');\n\nconst SHA256 = require('./sha256');\n\nconst RIPEMD160 = require('./ripemd160');\n\nconst HMAC = require('../internal/hmac');\n/*\n * Constants\n */\n\n\nconst rmd = new RIPEMD160();\n/**\n * Hash160\n */\n\nclass Hash160 {\n  constructor() {\n    this.ctx = new SHA256();\n  }\n\n  init() {\n    this.ctx.init();\n    return this;\n  }\n\n  update(data) {\n    this.ctx.update(data);\n    return this;\n  }\n\n  final() {\n    const out = Buffer.allocUnsafe(32);\n\n    this.ctx._final(out);\n\n    rmd.init();\n    rmd.update(out);\n\n    rmd._final(out);\n\n    return out.slice(0, 20);\n  }\n\n  static hash() {\n    return new Hash160();\n  }\n\n  static hmac() {\n    return new HMAC(Hash160, 64);\n  }\n\n  static digest(data) {\n    return Hash160.ctx.init().update(data).final();\n  }\n\n  static root(left, right) {\n    assert(Buffer.isBuffer(left) && left.length === 20);\n    assert(Buffer.isBuffer(right) && right.length === 20);\n    return Hash160.ctx.init().update(left).update(right).final();\n  }\n\n  static multi(x, y, z) {\n    const {\n      ctx\n    } = Hash160;\n    ctx.init();\n    ctx.update(x);\n    ctx.update(y);\n    if (z) ctx.update(z);\n    return ctx.final();\n  }\n\n  static mac(data, key) {\n    return Hash160.hmac().init(key).update(data).final();\n  }\n\n}\n/*\n * Static\n */\n\n\nHash160.native = 0;\nHash160.id = 'HASH160';\nHash160.size = 20;\nHash160.bits = 160;\nHash160.blockSize = 64;\nHash160.zero = Buffer.alloc(20, 0x00);\nHash160.ctx = new Hash160();\n/*\n * Expose\n */\n\nmodule.exports = Hash160;","map":null,"metadata":{},"sourceType":"script"}