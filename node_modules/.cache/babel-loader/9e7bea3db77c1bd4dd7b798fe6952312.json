{"ast":null,"code":"/*!\n * sha384.js - SHA384 implementation for bcrypto\n * Copyright (c) 2017-2019, Christopher Jeffrey (MIT License).\n * https://github.com/bcoin-org/bcrypto\n *\n * Parts of this software are based on indutny/hash.js:\n *   Copyright (c) 2014, Fedor Indutny (MIT License).\n *   https://github.com/indutny/hash.js\n *\n * Resources:\n *   https://en.wikipedia.org/wiki/SHA-2\n *   https://tools.ietf.org/html/rfc4634\n *   https://github.com/indutny/hash.js/blob/master/lib/hash/sha/384.js\n */\n'use strict';\n\nconst assert = require('../internal/assert');\n\nconst SHA512 = require('./sha512');\n\nconst HMAC = require('../internal/hmac');\n/**\n * SHA384\n */\n\n\nclass SHA384 extends SHA512 {\n  constructor() {\n    super();\n  }\n\n  init() {\n    this.state[0] = 0xcbbb9d5d;\n    this.state[1] = 0xc1059ed8;\n    this.state[2] = 0x629a292a;\n    this.state[3] = 0x367cd507;\n    this.state[4] = 0x9159015a;\n    this.state[5] = 0x3070dd17;\n    this.state[6] = 0x152fecd8;\n    this.state[7] = 0xf70e5939;\n    this.state[8] = 0x67332667;\n    this.state[9] = 0xffc00b31;\n    this.state[10] = 0x8eb44a87;\n    this.state[11] = 0x68581511;\n    this.state[12] = 0xdb0c2e0d;\n    this.state[13] = 0x64f98fa7;\n    this.state[14] = 0x47b5481d;\n    this.state[15] = 0xbefa4fa4;\n    this.size = 0;\n    return this;\n  }\n\n  final() {\n    return super.final().slice(0, 48);\n  }\n\n  static hash() {\n    return new SHA384();\n  }\n\n  static hmac() {\n    return new HMAC(SHA384, 128);\n  }\n\n  static digest(data) {\n    return SHA384.ctx.init().update(data).final();\n  }\n\n  static root(left, right) {\n    assert(Buffer.isBuffer(left) && left.length === 48);\n    assert(Buffer.isBuffer(right) && right.length === 48);\n    return SHA384.ctx.init().update(left).update(right).final();\n  }\n\n  static multi(x, y, z) {\n    const {\n      ctx\n    } = SHA384;\n    ctx.init();\n    ctx.update(x);\n    ctx.update(y);\n    if (z) ctx.update(z);\n    return ctx.final();\n  }\n\n  static mac(data, key) {\n    return SHA384.hmac().init(key).update(data).final();\n  }\n\n}\n/*\n * Static\n */\n\n\nSHA384.native = 0;\nSHA384.id = 'SHA384';\nSHA384.size = 48;\nSHA384.bits = 384;\nSHA384.blockSize = 128;\nSHA384.zero = Buffer.alloc(48, 0x00);\nSHA384.ctx = new SHA384();\n/*\n * Expose\n */\n\nmodule.exports = SHA384;","map":null,"metadata":{},"sourceType":"script"}