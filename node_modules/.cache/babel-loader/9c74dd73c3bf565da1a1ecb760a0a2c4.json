{"ast":null,"code":"/*!\n * hash256.js - Hash256 implementation for bcrypto\n * Copyright (c) 2017-2019, Christopher Jeffrey (MIT License).\n * https://github.com/bcoin-org/bcrypto\n *\n * Resources:\n *   https://github.com/bitcoin/bitcoin/blob/master/src/hash.h\n */\n'use strict';\n\nconst assert = require('../internal/assert');\n\nconst SHA256 = require('./sha256');\n\nconst HMAC = require('../internal/hmac');\n/**\n * Hash256\n */\n\n\nclass Hash256 {\n  constructor() {\n    this.ctx = new SHA256();\n  }\n\n  init() {\n    this.ctx.init();\n    return this;\n  }\n\n  update(data) {\n    this.ctx.update(data);\n    return this;\n  }\n\n  final() {\n    const out = Buffer.allocUnsafe(32);\n\n    this.ctx._final(out);\n\n    this.ctx.init();\n    this.ctx.update(out);\n\n    this.ctx._final(out);\n\n    return out;\n  }\n\n  static hash() {\n    return new Hash256();\n  }\n\n  static hmac() {\n    return new HMAC(Hash256, 64);\n  }\n\n  static digest(data) {\n    return Hash256.ctx.init().update(data).final();\n  }\n\n  static root(left, right) {\n    assert(Buffer.isBuffer(left) && left.length === 32);\n    assert(Buffer.isBuffer(right) && right.length === 32);\n    return Hash256.ctx.init().update(left).update(right).final();\n  }\n\n  static multi(x, y, z) {\n    const {\n      ctx\n    } = Hash256;\n    ctx.init();\n    ctx.update(x);\n    ctx.update(y);\n    if (z) ctx.update(z);\n    return ctx.final();\n  }\n\n  static mac(data, key) {\n    return Hash256.hmac().init(key).update(data).final();\n  }\n\n}\n/*\n * Static\n */\n\n\nHash256.native = 0;\nHash256.id = 'HASH256';\nHash256.size = 32;\nHash256.bits = 256;\nHash256.blockSize = 64;\nHash256.zero = Buffer.alloc(32, 0x00);\nHash256.ctx = new Hash256();\n/*\n * Expose\n */\n\nmodule.exports = Hash256;","map":null,"metadata":{},"sourceType":"script"}